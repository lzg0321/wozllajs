define("wozlla/wozllajs/1.0.0/wozlla",["./assets/AsyncImage","./utils/Arrays","./assets/Texture","./utils/Objects","./assets/loader","./utils/Strings","./utils/Promise","./utils/Ajax","./assets/objLoader","./core/Component","./utils/uniqueKey","./core/GameObject","./core/CachableGameObject","./core/UnityGameObject","./math/Rectangle","./math/Matrix2D","./core/AbstractGameObject","./events/EventTarget","./events/Event","./core/events/GameObjectEvent","./core/Transform","./core/Behaviour","./core/Animation","./core/Time","./core/Renderer","./core/Layout","./core/HitDelegate","./core/Mask","./utils/createCanvas","./core/Filter","./core/events/TouchEvent","./core/Collider","./core/Engine","./utils/Tuple","./core/Stage","./utils/listenAppState","./core/Touch","./core/GLGameObject","./core/WebGLStage","./math/geom","./component/Image"],function(a){return window.wozllajs={assets:{AsyncImage:a("./assets/AsyncImage"),Texture:a("./assets/Texture"),loader:a("./assets/loader"),objLoader:a("./assets/objLoader")},core:{events:{GameObjectEvent:a("./core/events/GameObjectEvent"),TouchEvent:a("./core/events/TouchEvent")},AbstractGameObject:a("./core/AbstractGameObject"),Animation:a("./core/Animation"),Behaviour:a("./core/Behaviour"),CachableGameObject:a("./core/CachableGameObject"),Collider:a("./core/Collider"),Component:a("./core/Component"),Engine:a("./core/Engine"),Filter:a("./core/Filter"),GameObject:a("./core/GameObject"),HitDelegate:a("./core/HitDelegate"),Layout:a("./core/Layout"),Mask:a("./core/Mask"),Renderer:a("./core/Renderer"),Stage:a("./core/Stage"),GLGameObject:a("./core/GLGameObject"),WebGLStage:a("./core/WebGLStage"),Time:a("./core/Time"),Touch:a("./core/Touch"),Transform:a("./core/Transform"),UnityGameObject:a("./core/UnityGameObject")},events:{Event:a("./events/Event"),EventTarget:a("./events/EventTarget")},math:{geom:a("./math/geom"),Matrix2D:a("./math/Matrix2D"),Rectangle:a("./math/Rectangle")},utils:{Ajax:a("./utils/Ajax"),Arrays:a("./utils/Arrays"),createCanvas:a("./utils/createCanvas"),Objects:a("./utils/Objects"),Promise:a("./utils/Promise"),Strings:a("./utils/Strings"),Tuple:a("./utils/Tuple"),uniqueKey:a("./utils/uniqueKey")},component:{Image:a("./component/Image")}}}),define("wozlla/wozllajs/1.0.0/assets/AsyncImage",["wozlla/wozllajs/1.0.0/utils/Arrays"],function(a,b,c){var d=(a("wozlla/wozllajs/1.0.0/utils/Arrays"),function(a,b){this.resourceId=a,this.image=b,this.src=b&&b.src,d.webGLContext&&(this.glTexture=null,this.setupGLTexture(d.webGLContext))});d.webGLContext=null;var e=d.prototype;e.setupGLTexture=function(a){var b,c=a;b=this.glTexture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,b),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this.image),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.bindTexture(c.TEXTURE_2D,null)},e.draw=function(a,b,c,d,e,f,g,h,i){var j=this.image,k=arguments.length;j&&(3===k&&a.drawImage(j,b,c),5===k&&a.drawImage(j,b,c,d,e),7===k?a.drawImage(j,b,c,d,e,f,g):a.drawImage(j,b,c,d,e,f,g,h,i))},e.drawAs9Grid=function(a,b,c,d,e){if(b&&c&&d&&e){var f=b.x,g=b.y,h=b.w,i=b.h,j=c.left,k=c.right,l=c.top,m=c.bottom;this.draw(a,f,g,j,l,0,0,j,l),this.draw(a,f+j,g+0,h-j-k,l,j,0,d-j-k,l),this.draw(a,f+h-k,g+0,k,l,d-k,0,k,l),this.draw(a,f+0,g+l,j,i-l-m,0,l,j,e-l-m),this.draw(a,f+0,g+i-m,j,m,0,e-m,j,m),this.draw(a,f+j,g+i-m,h-j-k,m,j,e-m,d-j-k,m),this.draw(a,f+h-k,g+i-m,k,m,d-k,e-m,k,m),this.draw(a,f+h-k,g+l,k,i-l-m,d-k,l,k,e-l-m),this.draw(a,f+j,g+l,h-j-k,i-l-m,j,l,d-j-k,e-l-m)}},e.draw3in1=function(a,b,c,d){if(b&&c&&d&&2===c.length&&3===d.length){var e=b.x,f=b.y,g=b.w,h=b.h;this.draw(a,e,f,c[0],h,0,0,d[0],h),this.draw(a,e+c[0],f,c[1]-c[0],h,d[0],0,d[1],h),this.draw(a,e+c[1],f,g-c[1],h,d[0]+d[1],0,d[2],h)}},e.dispose=function(){this.image&&this.image.dispose&&this.image.dispose(),this.image=null,d.webGLContext&&(d.webGLContext.deleteTexture(this.glTexture),this.glTexture=null)},c.exports=d}),define("wozlla/wozllajs/1.0.0/utils/Arrays",[],function(a,b){var c=Object.prototype.toString,d=Array.prototype.slice;b.is=function(a){return"[object Array]"===c.call(a)},b.isArray=function(a){return b.is(a)},b.slice=function(a){return d.apply(a,d.apply(arguments,[1]))}}),define("wozlla/wozllajs/1.0.0/assets/Texture",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/utils/Arrays"],function(a,b,c){var d=a("wozlla/wozllajs/1.0.0/utils/Objects"),e=a("wozlla/wozllajs/1.0.0/assets/AsyncImage"),f=function(a,b,c){e.apply(this,arguments),this.frames=c},g=d.inherits(f,e);g.getFrame=function(a){var b=this.frames[a];return b?b.frame:null},g.getSpriteSourceSize=function(a){var b=this.frames[a];return b?b.spriteSourceSize:null},g.drawFrame=function(a,b,c,d,e,f){var g=this.getFrame(b);g&&this.draw(a,g.x,g.y,g.w,g.h,c||0,d||0,e||g.w,f||g.h)},g.drawFrameAs9Grid=function(a,b,c,d,e){var f=this.getFrame(b);f&&this.drawAs9Grid(a,f,c,d,e)},g.drawFrameAs3in1=function(a,b,c,d){var e=this.getFrame(b);e&&this.draw3in1(a,e,c,d)},c.exports=f}),define("wozlla/wozllajs/1.0.0/utils/Objects",[],function(a,b){b.each=function(a,b){for(var c in a)if(!1===b(c,a[c]))return},b.inherits=function(a,b){return a._super=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})},b.getSuperConstructor=function(a){return"function"==typeof a?a._super:null}}),define("wozlla/wozllajs/1.0.0/assets/loader",["wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture"],function(a,b){function c(a,b){var c=new Image;c.src=a,c.onload=function(){b(null,c)},c.onerror=function(){b('Fail to load image "'+a+'"')}}function d(a){var b,c;return a.type?q[a.type]:(i.each(q,function(d,e){return c=a.src.substr(0,a.src.indexOf("?")),g.endWith(c,d)?(b=e,!1):void 0}),b)}function e(){var a,b,c,d,g,h,i,j,k;if(s||0===r.length)return f&&f(),void 0;if(s=!0,i=r.shift(),h=i.promise,g=i.items,0===g.length)return h.done(),s=!1,e(),void 0;for(k={},j=0,a=0,b=g.length;b>a;a++)c=g[a],c&&(d=c.id,o[d]?(delete n[c.id],k[d]=!0,j++,j===g.length&&(h.done(k),s=!1,e())):!function(a){return a.loader?(a.loader(a,function(b,c){a.error=b,a.result=c,delete n[a.id],b||(o[a.id]=a,k[a.id]=!0),j++,j===g.length&&(h.done(k),s=!1,e())}),void 0):(console.log("[Warn]: loader not found"),a.error="loader not found",a.result=null,j++,j===g.length&&(h.done(k),s=!1,e()),void 0)}(c))}var f,g=a("wozlla/wozllajs/1.0.0/utils/Strings"),h=a("wozlla/wozllajs/1.0.0/utils/Arrays"),i=a("wozlla/wozllajs/1.0.0/utils/Objects"),j=a("wozlla/wozllajs/1.0.0/utils/Promise"),k=a("wozlla/wozllajs/1.0.0/utils/Ajax"),l=a("wozlla/wozllajs/1.0.0/assets/AsyncImage"),m=a("wozlla/wozllajs/1.0.0/assets/Texture"),n={},o={},p={},q={},r=[],s=!1;q[".png"]=q[".jpg"]=q.image=function(a,b){c(a.src,function(c,d){c?b(c):b(null,new l(a.id,d))})},q.texture=function(a,b){var d=a.src.replace(".tt.json",".tt.png");c(d,function(c,d){c?b(c):k.getJSON(a.src).then(function(c){b(null,new m(a.id,d,c.frames))}).catchError(function(){k.getJSON(a.src).then(function(c){b(null,new m(a.id,d,c.frames))}).catchError(function(a){b(a)})})})},q.json=q[".json"]=function(a,b){k.getJSON(a.src).then(function(a){b(null,a)}).catchError(function(){k.getJSON(a.src).then(function(a){b(null,a)}).catchError(function(a){b(a)})})},b.baseURL="",b.printLoadingAssets=function(){console.log(n)},b.printUsingCounter=function(){console.log(p)},b.printAssets=function(){console.log(o)},b.setIdleCallback=function(a){f=a},b.nextCall=function(a){b.load([]).then(a)},b.load=function(a){var c,f,i,k;for(h.is(a)||(a=[a]),a=[].concat(a),c=0,f=a.length;f>c;c++)k=a[c],g.is(k)&&(k={id:k,src:k}),k.id||(k.id=k.src),k.src=b.baseURL+k.src+"?t="+Date.now(),k.loader=d(k),a[c]=k,n[k.id]=!0;return i=new j,r.push({items:a,promise:i}),e(),i},b.getItem=function(a){return o[a]},b.get=function(a){var c=b.getItem(a);return c?(p[a]=p[a]||0,p[a]++,c.result):null},b.remove=function(a){var b,c;if(p[a]&&p[a]--,b=o[a],b&&0===p[a]){if(delete o[a],delete p[a],c=b.result,n[a])return;c&&c.dispose&&"function"==typeof c.dispose&&c.dispose()}},b.computeImageMemory=function(){var a,b,c,d=0,e=function(a){for(var b=2;a>b;)b*=2;return b};for(a in o)b=o[a],b&&b.result instanceof l&&(c=b.result.image,d+=e(c.width)*e(c.height));return 4*d/1024/1024},b.computeUnpackImageMemory=function(){var a,b,c,d=0,e=function(a){for(var b=2;a>b;)b*=2;return b};for(a in o)if(b=o[a],b&&b.result instanceof m)for(var f=b.result.frames,g=0;g<f.length;g++){var h=f[g].frame;d+=e(h.w)*e(h.h)}else b&&b.result instanceof l&&(c=b.result.image,d+=e(c.width)*e(c.height));return 4*d/1024/1024}}),define("wozlla/wozllajs/1.0.0/utils/Strings",[],function(a,b){var c=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g;b.trim=function(a){return a.replace(c,"")},b.endWith=function(a,c){return b.is(a)?a.lastIndexOf(c)===a.length-c.length:!1},b.startWith=function(a,c){return b.is(a)?0===a.indexOf(c):!1},b.is=function(a){return"string"==typeof a}}),define("wozlla/wozllajs/1.0.0/utils/Promise",["wozlla/wozllajs/1.0.0/utils/Arrays"],function(a,b,c){var d=a("wozlla/wozllajs/1.0.0/utils/Arrays"),e=function(){this._thenQueue=[],this._errorQueue=[]};e.wait=function(a){var b,c,f=new e,g=0,h=[];for(1===arguments.length?d.is(a)||(a=[a]):a=d.slice(arguments),b=0,c=a.length;c>b;b++)!function(b,c){a[b].then(function(a){return g++,a=arguments.length>1?d.slice(arguments):a,h[b]=a,g===c&&f.done.apply(f,h),a}).catchError(function(a){f.sendError(a)})}(b,c);return f},e.run=function(a){var b;try{b=a(function(){var a=arguments;setTimeout(function(){b.done.apply(b,a)},1)},function(a){b.sendError(a)}),b&&b instanceof e||(b=new e)}catch(c){b&&b instanceof e||(b=new e),setTimeout(function(){b.sendError(c)},1)}return b};var f=e.prototype;f.then=function(a,b){return this._thenQueue.push({callback:a,context:b}),this},f.catchError=function(a,b){return this._errorQueue.push({callback:a,context:b}),this},f.done=function(){var a=this,b=arguments;return setTimeout(function(){a._nextThen.apply(a,b)},1),this},f.sendError=function(a){var b=this;return setTimeout(function(){b._nextError(a)},1),this},f._nextThen=function(){var a=this._thenQueue.shift();if(a){var b=a.callback.apply(a.context||this,arguments);b=d.isArray(b)?b:[b],this._nextThen.apply(this,b)}},f._nextError=function(){var a=this._errorQueue.shift();if(a){var b=a.callback.apply(a.context||this,arguments);b=d.isArray(b)?b:[b],this._nextError.apply(this,b)}},c.exports=e}),define("wozlla/wozllajs/1.0.0/utils/Ajax",["wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays"],function(a,b){var c=a("wozlla/wozllajs/1.0.0/utils/Promise"),d={toString:function(a){if(!a)return"";var b,c="";for(b in a)c+="&"+b+"="+a[b];return c&&(c=c.substr(1)),c},toQuery:function(){}},e=function(a,b,c,e,f,g){b+="?"+d.toString(c),a.open("GET",b,g),a.setRequestHeader("Content-Type",e),a.send()},f=function(){},g=function(){return new XMLHttpRequest};b.param=d,b.request=function(a){var b,d=new c,h=Date.now(),i=a.url,j=a.method||"GET",k=a.data,l=a.dataType||"text",m=a.contentType||"application/x-www-form-urlencoded; charset=UTF-8",n=a.async,o="text/plain",p="responseText",q=function(a){return a};switch(l.toLowerCase()){case"json":o="application/json",q=JSON.parse;break;case"script":case"js":o="text/javascript";break;case"xml":o="text/xml",p="responseXML"}n=n===!1?n:!0,k&&(k.t?k._=h:k.t=h),b=g(),b.overrideMimeType&&b.overrideMimeType(o);try{switch(j.toUpperCase()){case"GET":e(b,i,k,m,l,n);break;case"POST":f(b,i,k,m,l,n);break;default:d.sendError(new Error("Unknow request method: "+j))}}catch(r){d.sendError(r)}return b.onreadystatechange=function(){var a;if(4===b.readyState){try{a=q(b[p])}catch(c){return d.sendError(c),void 0}d.done(a,b)}},d},b.get=function(a,c){return b.request({url:a,method:"GET",data:c})},b.getJSON=function(a,c){return b.request({url:a,method:"GET",data:c,dataType:"json"})},b.post=function(a,c){return b.request({url:a,method:"POST",data:c})}}),define("wozlla/wozllajs/1.0.0/assets/objLoader",["wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/core/GameObject","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter"],function(a,b){var c=a("wozlla/wozllajs/1.0.0/assets/loader"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=a("wozlla/wozllajs/1.0.0/core/GameObject");b.buildGameObject=function(a){var c,d,f,g,h,i;for(g=new e({name:a.name,id:a.gid,tags:a.tags}),g.setActive(a.active),g.setVisible(a.visible),g.setWidth(a.width||0),g.setHeight(a.height||0),g.setInteractive(a.interactive),g.transform.applyTransform(a.transform),h=a.children,i=a.components,c=0,d=h.length;d>c;c++)g.addObject(b.buildGameObject(h[c]));for(c=0,d=i.length;d>c;c++)f=b.buildComponent(i[c]),f&&g.addComponent(f);return g},b.buildComponent=function(a){var b,c,e;if(b=d.getConstructor(a.id),c=a.properties,b&&(e=new b,e.properties={},c))for(var f in c)e.properties[f]=c[f];return e},b.loadObjFile=function(a){return c.load({id:a,src:a,type:"json"})},b.loadAndInitObjFile=function(a,d){return b.loadObjFile(a).then(function(){var e=c.get(a),f=b.buildGameObject(e);return d&&c.remove(a),f})},b.loadAndInitObjFileToObjs=function(a,d,e){return b.loadObjFile(a).then(function(){var f=[];for(var g in d){var h=c.get(a),i=b.buildGameObject(h);i.setName(h.name+d[g]),f.push(i)}return e&&c.remove(a),[f]})},b.loadObjFiles=function(a){var b=[];for(var d in a)b.push({id:a[d],src:a[d],type:"json"});return c.load(b)},b.loadAndInitObjFiles=function(a,d){return b.loadObjFiles(a).then(function(){var e=[];for(var f in a){var g=c.get(a[f]),h=b.buildGameObject(g);d&&c.remove(a[f]),e.push(h)}return[e]})}}),define("wozlla/wozllajs/1.0.0/core/Component",["wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(a){this.UID=d(),this.gameObject=null,this.properties=a||{}}var c=a("wozlla/wozllajs/1.0.0/assets/loader"),d=a("wozlla/wozllajs/1.0.0/utils/uniqueKey"),e={};b.getConstructor=function(a){var b=e[a];return b||console.log('[Warn] Unknow component "'+a+'"'),b},b.getRegistry=function(){return e},b.unregisterAll=function(){e={}},b.register=function(a){var b=a.prototype.id,c=a.prototype.alias;if(!b||!c)throw new Error("component must define id and alias.");if(e[b])throw new Error('component id "'+b+'" has been registered.');if(e[c])throw new Error('component alias "'+c+'" has been registered.');e[b]=a,e[c]=a};var f=b.prototype;return f.id=void 0,f.alias=void 0,f.setGameObject=function(a){this.gameObject=a},f.applyProperties=function(){for(var a in this.properties)(void 0===this[a]||null===this[a])&&(this[a]=this.properties[a])},f.initComponent=function(){},f.destroyComponent=function(){},f.on=function(){this.gameObject.addEventListener.apply(this.gameObject,arguments)},f.off=function(){this.gameObject.removeEventListener.apply(this.gameObject,arguments)},f.dispatchEvent=function(a){this.gameObject.dispatchEvent(a)},f.getResource=function(a){return c.get(a)},f.loadResource=function(a,b){return c.load(a,b)},f.unloadResource=function(a){"string"==typeof a&&(a=[a]);var b,d;for(b=0,d=a.length;d>b;b++)c.remove(a[b])},f.isInstanceof=function(a){return this instanceof a},b}),define("wozlla/wozllajs/1.0.0/utils/uniqueKey",[],function(){var a=1;return function(){return a++}}),define("wozlla/wozllajs/1.0.0/core/GameObject",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter"],function(a){var b={},c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/CachableGameObject"),e=a("wozlla/wozllajs/1.0.0/core/events/GameObjectEvent"),f=function(){var a=this;d.apply(this,arguments),this.id&&(b[this.id]=this,this.addEventListener(e.DESTROY,function(c){c.target===a&&(c.removeListener(),delete b[a.id])}))};return f.idMap=b,c.inherits(f,d),f.getById=function(a){return b[a]},f}),define("wozlla/wozllajs/1.0.0/core/CachableGameObject",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter"],function(a){var b=a("wozlla/wozllajs/1.0.0/utils/Objects"),c=a("wozlla/wozllajs/1.0.0/core/UnityGameObject"),d=a("wozlla/wozllajs/1.0.0/core/Filter"),e=a("wozlla/wozllajs/1.0.0/utils/createCanvas"),f=function(){c.apply(this,arguments),this._cacheCanvas=null,this._cacheContext=null,this._cached=!1,this._cacheOffsetX=0,this._cacheOffsetY=0},g=b.inherits(f,c);return g.cache=function(a,b,c,d){this._cacheCanvas&&this.uncache(),this._cacheOffsetX=a,this._cacheOffsetY=b,this._cacheCanvas=e(c,d),this._cacheContext=this._cacheCanvas.getContext("2d"),this._cached=!1},g.updateCache=function(a,b){this._cached=!1,this._cacheOffsetX=a||this._cacheOffsetX,this._cacheOffsetY=b||this._cacheOffsetY},g.translateCache=function(a,b){this._cached=!1,this._cacheOffsetX+=a,this._cacheOffsetY+=b},g.uncache=function(){this._cacheCanvas&&(this._cacheContext.dispose&&this._cacheContext.dispose(),this._cacheCanvas.dispose&&this._cacheCanvas.dispose(),this._cacheCanvas=null),this._cached=!1},g._draw=function(a){this._cacheCanvas?(this._cached||(this._drawCache(),this._cached=!0),a.drawImage(this._cacheCanvas,0,0)):c.prototype._draw.apply(this,arguments)},g._drawCache=function(a,b){var d=this._cacheContext;d.clearRect(0,0,this._cacheCanvas.width,this._cacheCanvas.height),d=this._cacheContext,d.translate(-this._cacheOffsetX,-this._cacheOffsetY),c.prototype._draw.apply(this,[d,b]),d.translate(this._cacheOffsetX,this._cacheOffsetY),this._applyFilters(d,0,0,this._cacheCanvas.width,this._cacheCanvas.height)},g._applyFilters=function(a,b,c,e,f){var g,h,i=this.getComponents(d);for(g in i)a.save(),h=i[g],h.applyFilter(a,b,c,e,f),a.restore()},f}),define("wozlla/wozllajs/1.0.0/core/UnityGameObject",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas"],function(a){var b=a("wozlla/wozllajs/1.0.0/utils/Objects"),c=a("wozlla/wozllajs/1.0.0/math/Rectangle"),d=a("wozlla/wozllajs/1.0.0/math/Matrix2D"),e=(a("wozlla/wozllajs/1.0.0/utils/Promise"),a("wozlla/wozllajs/1.0.0/core/AbstractGameObject")),f=a("wozlla/wozllajs/1.0.0/core/Component"),g=a("wozlla/wozllajs/1.0.0/core/Behaviour"),h=a("wozlla/wozllajs/1.0.0/core/Animation"),i=a("wozlla/wozllajs/1.0.0/core/Renderer"),j=a("wozlla/wozllajs/1.0.0/core/Layout"),k=a("wozlla/wozllajs/1.0.0/core/HitDelegate"),l=a("wozlla/wozllajs/1.0.0/core/Mask"),m=a("wozlla/wozllajs/1.0.0/core/events/GameObjectEvent"),n=a("wozlla/wozllajs/1.0.0/utils/createCanvas"),o=a("wozlla/wozllajs/1.0.0/assets/loader"),p=n(1,1),q=p.getContext("2d"),r=(new c,new d),s=function(){e.apply(this,arguments),this._active=!0,this._visible=!0,this._width=0,this._height=0,this._interactive=!1,this._initialized=!1,this._components=[],this._delayRemoves=[],this.customData={}},t=b.inherits(s,e);return t.isActive=function(a){if(a===!1)return this._active;for(var b=!0,c=this;c;){if(b=b&&c._active,!b)return!1;c=c._parent}return b},t.setActive=function(a){this._active=a},t.isVisible=function(a){if(a===!1)return this._visible;for(var b=!0,c=this;c;){if(b=b&&c._visible,!b)return!1;c=c._parent}return b},t.setVisible=function(a){this._visible=a},t.isInteractive=function(){return this._children.length>0||this._interactive},t.setInteractive=function(a){this._interactive=a},t.getWidth=function(){return this._width},t.setWidth=function(a){this._width=a},t.getHeight=function(){return this._height},t.setHeight=function(a){this._height=a},t.getGlobalBounds=function(a,b){a||(a=new c);var d=this.transform,e=this.transform.getConcatenatedMatrix(r),f=d.localToGlobal(0,0,e),g=d.localToGlobal(this._width,0,e),h=d.localToGlobal(0,this._height,e),i=d.localToGlobal(this._width,this._height,e);return b&&console.log(f,g,h,i),a.x=Math.min(f.x,g.x,h.x,i.x),a.y=Math.min(f.y,g.y,h.y,i.y),a.width=Math.max(f.x,g.x,h.x,i.x)-a.x,a.height=Math.max(f.y,g.y,h.y,i.y)-a.y,a},t.query=function(a){var b=a.split(":"),c=this.getObjectByName(b[0]);return b[1]&&(c=c.getComponent(b[1])),c},t.addComponent=function(a){this._components.push(a),a.setGameObject(this)},t.getComponent=function(a){var b,c,d,e,f=this._components;if("string"==typeof a){for(e=a,b=0,c=f.length;c>b;b++)if(d=f[b],d.alias===e)return d}else for(b=0,c=f.length;c>b;b++)if(d=f[b],d.isInstanceof(a))return d;return null},t.getComponents=function(a){var b,c,d,e,f=this._components,g=[];if("string"==typeof a)for(e=a.toLowerCase(),b=0,c=f.length;c>b;b++)d=f[b],d.alias.toLowerCase()===e&&g.push(d);else for(b=0,c=f.length;c>b;b++)d=f[b],d.isInstanceof(a)&&g.push(d);return g},t.removeComponent=function(a){var b,c,d,e=this._components;for(b=0,c=e.length;c>b;b++)if(d=e[b],d===a){e.splice(b,1),d.setGameObject(null);break}},t.removeAllComponents=function(){this._components.length=0},t.delayRemoveComponent=function(a){this._delayRemoves.push(a)},t.delayRemoveObject=function(a){this._delayRemoves.push(a)},t.delayRemove=function(){this._parent.delayRemoveObject(this)},t.sendMessage=function(a,b,c){var d,e,f,g,h=this._components;for(d=0,e=h.length;e>d;d++)f=h[d],(!c||c&&f.isInstanceof(c))&&(g=f[a],g&&g.apply(f,b))},t.broadcastMessage=function(a,b){var c,d,e,f=this._children;for(c=0,d=f.length;d>c;c++)e=f[c],e.broadcastMessage(a,b);this.sendMessage(a,b)},t.init=function(a){var b,c,d,e=this._children;for(this.sendMessage("initComponent"),b=0,c=e.length;c>b;b++)d=e[b],d.init();this.layout(),this._doDelayRemove(),this._initialized=!0,this.dispatchEvent(new m({type:m.INIT,bubbles:!0})),a&&o.nextCall(a)},t.destroy=function(){var a,b,c,d=this._children;for(a=0,b=d.length;b>a;a++)c=d[a],c.destroy();this._doDelayRemove(),this.sendMessage("destroyComponent"),this.dispatchEvent(new m({type:m.DESTROY,bubbles:!0})),this.removeAllListeners()},t.layout=function(){var a,b,c,d=this.getComponent(j),e=this._children;for(a=0,b=e.length;b>a;a++)c=e[a],c.layout();d&&d.doLayout()},t.update=function(){if(this._initialized&&this._active){var a,b,c,d=this._children;for(a=0,b=d.length;b>a;a++)c=d[a],c.update();this.sendMessage("update",null,g),this._doDelayRemove()}},t.lateUpdate=function(){if(this._initialized&&this._active){var a,b,c,d=this._children;for(a=0,b=d.length;b>a;a++)c=d[a],c.lateUpdate();this.sendMessage("lateUpdate",null,g),this._doDelayRemove()}},t.draw=function(a,b){var c;this._initialized&&this._active&&this._visible&&(this.transform.updateContext(a,c),this._draw(a,b),this.transform.reupdateContext(a,c),this._doDelayRemove())},t.testHit=function(a,b,c){var d,e=!1;return this.isActive(!0)&&this.isVisible(!0)?(d=this.getComponent(k),d?e=d.testHit(a,b):c||(q.setTransform(1,0,0,1,-a,-b),this._draw(q,this.getStage().getVisibleRect()),e=q.getImageData(0,0,1,1).data[3]>1,q.setTransform(1,0,0,1,0,0),q.clearRect(0,0,2,2)),e):!1},t.getTopObjectUnderPoint=function(a,b,c){var d,e,f,g,h,i=this._children;if(c&&!this.isInteractive())return null;if(i.length>0)for(h=!0,d=i.length-1;d>=0;d--)if(e=i[d],f=e.getTopObjectUnderPoint(a,b,c))return f;return this._interactive&&(g=this.transform.globalToLocal(a,b),this.testHit(g.x,g.y,h))?this:null},t.animate=function(a,b){var c,d,e,f=this.getComponents(h);for(c=0,d=f.length;d>c;c++)if(e=f[c],e.name===a){e.play(b);break}},t.playEffect=function(){},t._doDelayRemove=function(){var a,b,c;if(this._delayRemoves.length>0){for(a=0,b=this._delayRemoves.length;b>a;a++)c=this._delayRemoves[a],c instanceof e?this.removeObject(c):c instanceof f&&this.removeComponent(c);this._delayRemoves.length=0}},t._draw=function(a,b){var c,d,e,f,g=this._children;if(g.length<=0)f=this.getComponent(l),f&&f.clip(a),this.sendMessage("draw",arguments,i);else for(f=this.getComponent(l),f&&f.clip(a),c=0,d=g.length;d>c;c++)e=g[c],e.draw(a,b)},s}),define("wozlla/wozllajs/1.0.0/math/Rectangle",[],function(){var a=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},b=a.prototype;return b.top=function(){return this.y},b.left=function(){return this.x},b.right=function(){return this.x+this.width},b.bottom=function(){return this.y+this.height},b.contains=function(a,b){return this.x<=a&&this.y<=b&&this.x+this.width>a&&this.y+this.height>b},b.containsPoint=function(a){return this.contains(a.x,a.y)},b.intersects=function(a,b,c,d){return this.x<a+c&&this.x+this.width>a&&this.y<b+d&&this.y+this.height>b},b.intersectRect=function(a){return this.intersects(a.x,a.y,a.width,a.height)},a.MAX_RECT=new a(Number.MIN_VALUE,Number.MIN_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a}),define("wozlla/wozllajs/1.0.0/math/Matrix2D",[],function(){var a=function(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)},b=a.prototype;return a.identity=null,a.DEG_TO_RAD=Math.PI/180,b.a=1,b.b=0,b.c=0,b.d=1,b.tx=0,b.ty=0,b.alpha=1,b.shadow=null,b.compositeOperation=null,b.initialize=function(a,b,c,d,e,f){return this.a=null==a?1:a,this.b=b||0,this.c=c||0,this.d=null==d?1:d,this.tx=e||0,this.ty=f||0,this},b.prepend=function(a,b,c,d,e,f){var g=this.tx;if(1!=a||0!=b||0!=c||1!=d){var h=this.a,i=this.c;this.a=h*a+this.b*c,this.b=h*b+this.b*d,this.c=i*a+this.d*c,this.d=i*b+this.d*d}return this.tx=g*a+this.ty*c+e,this.ty=g*b+this.ty*d+f,this},b.append=function(a,b,c,d,e,f){var g=this.a,h=this.b,i=this.c,j=this.d;return this.a=a*g+b*i,this.b=a*h+b*j,this.c=c*g+d*i,this.d=c*h+d*j,this.tx=e*g+f*i+this.tx,this.ty=e*h+f*j+this.ty,this},b.prependMatrix=function(a){return this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty),this.prependProperties(a.alpha,a.shadow,a.compositeOperation),this},b.appendMatrix=function(a){return this.append(a.a,a.b,a.c,a.d,a.tx,a.ty),this.appendProperties(a.alpha,a.shadow,a.compositeOperation),this},b.prependTransform=function(b,c,d,e,f,g,h,i,j){if(f%360)var k=f*a.DEG_TO_RAD,l=Math.cos(k),m=Math.sin(k);else l=1,m=0;return(i||j)&&(this.tx-=i,this.ty-=j),g||h?(g*=a.DEG_TO_RAD,h*=a.DEG_TO_RAD,this.prepend(l*d,m*d,-m*e,l*e,0,0),this.prepend(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),b,c)):this.prepend(l*d,m*d,-m*e,l*e,b,c),this},b.appendTransform=function(b,c,d,e,f,g,h,i,j){if(f%360)var k=f*a.DEG_TO_RAD,l=Math.cos(k),m=Math.sin(k);else l=1,m=0;return g||h?(g*=a.DEG_TO_RAD,h*=a.DEG_TO_RAD,this.append(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),b,c),this.append(l*d,m*d,-m*e,l*e,0,0)):this.append(l*d,m*d,-m*e,l*e,b,c),(i||j)&&(this.tx-=i*this.a+j*this.c,this.ty-=i*this.b+j*this.d),this},b.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},b.skew=function(b,c){return b*=a.DEG_TO_RAD,c*=a.DEG_TO_RAD,this.append(Math.cos(c),Math.sin(c),-Math.sin(b),Math.cos(b),0,0),this},b.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},b.translate=function(a,b){return this.tx+=a,this.ty+=b,this},b.identity=function(){return this.alpha=this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.shadow=this.compositeOperation=null,this},b.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},b.isIdentity=function(){return 0==this.tx&&0==this.ty&&1==this.a&&0==this.b&&0==this.c&&1==this.d},b.transformPoint=function(a,b,c){return c=c||{},c.x=a*this.a+b*this.c+this.tx,c.y=a*this.b+b*this.d+this.ty,c},b.decompose=function(b){null==b&&(b={}),b.x=this.tx,b.y=this.ty,b.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),b.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var c=Math.atan2(-this.c,this.d),d=Math.atan2(this.b,this.a);return c==d?(b.rotation=d/a.DEG_TO_RAD,this.a<0&&this.d>=0&&(b.rotation+=b.rotation<=0?180:-180),b.skewX=b.skewY=0):(b.skewX=c/a.DEG_TO_RAD,b.skewY=d/a.DEG_TO_RAD),b
},b.reinitialize=function(a,b,c,d,e,f,g,h,i){return this.initialize(a,b,c,d,e,f),this.alpha=null==g?1:g,this.shadow=h,this.compositeOperation=i,this},b.copy=function(a){return this.reinitialize(a.a,a.b,a.c,a.d,a.tx,a.ty,a.alpha,a.shadow,a.compositeOperation)},b.appendProperties=function(a,b,c){return this.alpha*=a,this.shadow=b||this.shadow,this.compositeOperation=c||this.compositeOperation,this},b.prependProperties=function(a,b,c){return this.alpha*=a,this.shadow=this.shadow||b,this.compositeOperation=this.compositeOperation||c,this},b.clone=function(){return(new a).copy(this)},b.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"},a.identity=new a,a}),define("wozlla/wozllajs/1.0.0/core/AbstractGameObject",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/math/Matrix2D"],function(a){var b=a("wozlla/wozllajs/1.0.0/utils/Objects"),c=a("wozlla/wozllajs/1.0.0/utils/uniqueKey"),d=a("wozlla/wozllajs/1.0.0/events/EventTarget"),e=a("wozlla/wozllajs/1.0.0/core/events/GameObjectEvent"),f=a("wozlla/wozllajs/1.0.0/core/Transform"),g=function(a){if(d.apply(this,arguments),this.id=a.id,this.name=a.name,this.tags=a.tags,this.tagsHash={},this.tags)for(var b=this.tags.split(" "),e=0,g=b.length;g>e;e++)this.tagsHash[b[e]]=!0;this.UID=c(),this.transform=new f({gameObject:this}),this._parent=null,this._children=[],this._childrenMap={}},h=b.inherits(g,d);return h.setName=function(a){this._parent&&(delete this._parent._childrenMap[this.name],this._parent._childrenMap[a]=this),this.name=a},h.isTagged=function(a){return this.tagsHash[a]},h.getParent=function(){return this._parent},h.getPath=function(a){for(var b=this,c=[];b&&!b.isStage;)c.unshift(b.name),b=b._parent;return c.join(a||"/")},h.getStage=function(){for(var a=this;a&&!a.isStage;)a=a._parent;return a&&a.isStage?a:null},h.indexInParent=function(){return this._parent?this._parent.getChildIndex(this):-1},h.getChildIndex=function(a){return this._children.indexOf(a)},h.getChildren=function(){return this._children.slice()},h.sortChildren=function(a){this._children.sort(a),this.dispatchEvent(new e({type:e.CHANGED,bubbles:!1}))},h.getObjectByName=function(a){return this._childrenMap[a]},h.addObject=function(a){this._childrenMap[a.name]=a,this._children.push(a),a._parent=this,this.dispatchEvent(new e({type:e.ADDED,bubbles:!1,child:a}))},h.insertObject=function(a,b){this._childrenMap[a.name]=a,this._children.splice(b,0,a),a._parent=this,this.dispatchEvent(new e({type:e.ADDED,bubbles:!1,child:a}))},h.insertBefore=function(a,b){var c,d,e,f=0;for(c=0,d=this._children.length;d>c;c++)if(e=this._children[c],e===b||e.name===b){f=c;break}this.insertObject(a,f)},h.insertAfter=function(a,b){var c,d,e,f=this._children.length;for(c=0,d=this._children.length;d>c;c++)if(e=this._children[c],e===b||e.name===b){f=c;break}this.insertObject(a,f+1)},h.removeObject=function(a){var b,c,d=this._children,f="string"==typeof a?this._childrenMap[a]:a,g=-1;for(b=0,c=d.length;c>b;b++)if(f===d[b]){g=b,d.splice(g,1);break}return-1!==g&&(delete this._childrenMap[f.name],f._parent=null,this.dispatchEvent(new e({type:e.REMOVED,bubbles:!1,child:f}))),g},h.remove=function(){this._parent&&this._parent.removeObject(this),this._parent=null},h.removeAll=function(){this._children=[],this._childrenMap={}},h.findObjectByName=function(a){var b,c,d,e=this.getObjectByName(a);if(!e)for(d=this._children,b=0,c=d.length;c>b&&!(e=d[b].findObjectByName(a));b++);return e},h.findObjectByPath=function(a,b){var c,d,e=a.split(b||"/"),f=this.findObjectByName(e[0]);if(f)for(c=1,d=e.length;d>c;c++)if(f=f.getObjectByName(e[c]),!f)return null;return f},g}),define("wozlla/wozllajs/1.0.0/events/EventTarget",["wozlla/wozllajs/1.0.0/events/Event"],function(a,b,c){var d=a("wozlla/wozllajs/1.0.0/events/Event"),e=function(){this._captureListeners={},this._listeners={}};e.DEFAULT_ACTION_MAP={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",click:"onClick"};var f=e.prototype;f.addEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners,e=d[a];return e&&this.removeEventListener(a,b,c),e=d[a],e?e.push(b):d[a]=[b],b},f.removeEventListener=function(a,b,c){var d=c?this._captureListeners:this._listeners;if(d){var e=d[a];if(e)for(var f=0,g=e.length;g>f;f++)if(e[f]==b){1==g?delete d[a]:e.splice(f,1);break}}},f.removeAllListeners=function(){this._captureListeners={},this._listeners={}},f.hasEventListener=function(a){var b=this._listeners,c=this._captureListeners;return!!(b&&b[a]||c&&c[a])},f.dispatchEvent=function(a){var b,c,f,g,h;if(a.target=this,!1===a.bubbles)return a.eventPhase=d.TARGET_PHASE,this._dispatchEvent(a)||(h=this[e.DEFAULT_ACTION_MAP[a.type]],h&&h(a)),void 0;for(f=this._getAncients(),a.eventPhase=d.CAPTURING_PHASE,b=f.length-1;b>=0;b--)if(g=f[b],g._dispatchEvent(a)||(h=g[e.DEFAULT_ACTION_MAP[a.type]],h&&h(a)),a._propagationStoped)return;if(a.eventPhase=d.TARGET_PHASE,this._dispatchEvent(a)||(h=this[e.DEFAULT_ACTION_MAP[a.type]],h&&h(a)),!a._propagationStoped)for(a.eventPhase=d.BUBBLING_PHASE,b=0,c=f.length;c>b;b++)if(g=f[b],g._dispatchEvent(a)||(h=g[e.DEFAULT_ACTION_MAP[a.type]],h&&h(a)),a._propagationStoped)return},f._getAncients=function(){for(var a=[],b=this;b._parent;)b=b._parent,a.push(b);return a},f._dispatchEvent=function(a){var b,c,e,f,g,h;if(a.currentTarget=this,a._listenerRemoved=!1,g=a.eventPhase===d.CAPTURING_PHASE?this._captureListeners:this._listeners){if(e=g[a.type],f=g["*"],e&&e.length>0)for(e=e.slice(),b=0,c=e.length;c>b&&(a._listenerRemoved=!1,h=e[b],h(a),a._listenerRemoved&&this.removeEventListener(a.type,h,a.eventPhase===d.CAPTURING_PHASE),!a._immediatePropagationStoped);b++);if(f&&f.length>0)for(f=f.slice(),b=0,c=f.length;c>b;b++)a._listenerRemoved=!1,h=f[b],h(a),a._listenerRemoved&&this.removeEventListener("*",h,a.eventPhase===d.CAPTURING_PHASE)}return a._defaultPrevented},c.exports=e}),define("wozlla/wozllajs/1.0.0/events/Event",[],function(a,b,c){var d=function(a){this.type=a.type,this.target=null,this.currentTarget=null,this.eventPhase=null,this.bubbles=a.bubbles,this._immediatePropagationStoped=!1,this._propagationStoped=!1,this._defaultPrevented=!1,this._listenerRemoved=!1};d.CAPTURING_PHASE=1,d.BUBBLING_PHASE=2,d.TARGET_PHASE=3;var e=d.prototype;e.isPropagationStopped=function(){return this._propagationStoped},e.stopImmediatePropagation=function(){this._immediatePropagationStoped=!0,this._propagationStoped=!0},e.stopPropagation=function(){this._propagationStoped=!0},e.preventDefault=function(){this._defaultPrevented=!0},e.removeListener=function(){this._listenerRemoved=!0},c.exports=d}),define("wozlla/wozllajs/1.0.0/core/events/GameObjectEvent",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/events/Event"],function(a){var b=a("wozlla/wozllajs/1.0.0/utils/Objects"),c=a("wozlla/wozllajs/1.0.0/events/Event"),d=function(a){c.apply(this,arguments),this.child=a.child};d.INIT="init",d.DESTROY="destroy",d.CHANGED="changed",d.ADDED="added",d.REMOVED="removed";b.inherits(d,c);return d}),define("wozlla/wozllajs/1.0.0/core/Transform",["wozlla/wozllajs/1.0.0/math/Matrix2D"],function(a){var b=a("wozlla/wozllajs/1.0.0/math/Matrix2D"),c=new b,d=function(a){this.x=0,this.y=0,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.alpha=1,this.relative=!0,this.gameObject=a.gameObject};return d.prototype={getRoot:function(){for(var a=this.gameObject;a&&a._parent;)a=a._parent;return a.transform},localToGlobal:function(a,b,d){var e;return d?(c.copy(d),e=c):e=this.getConcatenatedMatrix(),null==e?null:(e.append(1,0,0,1,a,b),{x:e.tx,y:e.ty})},globalToLocal:function(a,b,d){var e;return d?(c.copy(d),e=c):e=this.getConcatenatedMatrix(),null==e?null:(e.invert(),e.append(1,0,0,1,a,b),{x:e.tx,y:e.ty})},getConcatenatedMatrix:function(a){var b=this,d=a||c;for(d.identity();null!=b&&(d.prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY).prependProperties(b.alpha),b.relative);)b=b.gameObject._parent,b&&(b=b.transform);return d},getMatrix:function(){var a=this;return c.identity().appendTransform(a.x,a.y,a.scaleX,a.scaleY,a.rotation,a.skewX,a.skewY,a.regX,a.regY).appendProperties(a.alpha)},updateContext:function(a,b){var d,e=this;this.relative?(b&&this.isOnlyTranslate()?a.translate(this.x,this.y):(a.save(),d=c.identity().appendTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY),a.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)),a.globalAlpha*=e.alpha):(a.save(),d=this.getAbsoluteMatrix(),a.setTransform(d.a,d.b,d.c,d.d,d.tx,d.ty),a.globalAlpha=e.alpha)},reupdateContext:function(a,b){this.relative&&b&&this.isOnlyTranslate()?(a.translate(-this.x,-this.y),a.globalAlpha/=this.alpha):a.restore()},isOnlyTranslate:function(){return 1===this.scaleX&&1===this.scaleY&&0===this.rotation&&0===this.regX&&0===this.regY&&0===this.skewX&&0===this.skewX?!0:!1},getAbsoluteMatrix:function(a){var b=this;return a=a||c,a.identity().prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY).prependProperties(b.alpha),a},applyTransform:function(a){this.x=a.x,this.y=a.y,this.regX=a.regX,this.regY=a.regY,this.scaleX=a.scaleX,this.scaleY=a.scaleY,this.rotation=a.rotation,this.alpha=a.alpha,this.skewX=a.skewX,this.skewY=a.skewY}},d}),define("wozlla/wozllajs/1.0.0/core/Behaviour",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.update=function(){},e.lateUpdate=function(){},b}),define("wozlla/wozllajs/1.0.0/core/Animation",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){e.apply(this,arguments),this.name=null,this.enabled=!1,this.callbacks=[]}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Time"),e=a("wozlla/wozllajs/1.0.0/core/Behaviour"),f=c.inherits(b,e);return f.update=function(){this.enabled&&this.tick(d.delta)},f.play=function(a){this.enabled=!0,this.callbacks.push(a)},f.stop=function(){this.enabled=!1},f.tick=function(){throw new Error("abstract method")},f.done=function(){for(var a=this.callbacks,b=0,c=a.length;c>b;b++)a[b]()},b}),define("wozlla/wozllajs/1.0.0/core/Time",[],function(){return{delta:0,now:0,measuredFPS:0,update:function(){var a=Date.now();this.now&&(this.delta=a-this.now,this.measuredFPS=1e3/this.delta),this.now=a},reset:function(){this.delta=0,this.now=0}}}),define("wozlla/wozllajs/1.0.0/core/Renderer",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.draw=function(){},e.isPreparedToDraw=function(){return!1},e.getTextureDescription=function(){},b}),define("wozlla/wozllajs/1.0.0/core/Layout",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.doLayout=function(){},b}),define("wozlla/wozllajs/1.0.0/core/HitDelegate",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.testHit=function(){},b}),define("wozlla/wozllajs/1.0.0/core/Mask",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.clip=function(){throw new Error("abstract method")},b}),define("wozlla/wozllajs/1.0.0/utils/createCanvas",[],function(){return function(a,b,c){var d=document.createElement(navigator.isCocoonJS&&c?"screencanvas":"canvas");return d.width=a,d.height=b,d}}),define("wozlla/wozllajs/1.0.0/core/Filter",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=c.inherits(b,d);return e.applyFilter=function(){},b}),define("wozlla/wozllajs/1.0.0/core/events/TouchEvent",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/events/Event"],function(a){var b=a("wozlla/wozllajs/1.0.0/utils/Objects"),c=a("wozlla/wozllajs/1.0.0/events/Event"),d=function(a){c.apply(this,arguments),this.x=a.x,this.y=a.y,this.touch=a.touch,this.touches=a.touches,this.touchMoveDetection=!1};d.TOUCH_START="touchstart",d.TOUCH_END="touchend",d.TOUCH_MOVE="touchmove",d.CLICK="click";var e=b.inherits(d,c);return e.setTouchMoveDetection=function(a){this.touchMoveDetection=a},d}),define("wozlla/wozllajs/1.0.0/core/Collider",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey"],function(a){function b(){d.apply(this,arguments)}{var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component");c.inherits(b,d)}return b}),define("wozlla/wozllajs/1.0.0/core/Engine",["wozlla/wozllajs/1.0.0/utils/Tuple","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Stage","wozlla/wozllajs/1.0.0/utils/listenAppState","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter","wozlla/wozllajs/1.0.0/core/Touch","wozlla/wozllajs/1.0.0/core/events/TouchEvent"],function(a){function b(){return k?(f.update(),c(),g.root&&g.root.tick(),f.measuredFPS<m?(n-=1,0>=n&&(n=1)):f.measuredFPS>m&&(n+=1),l?h(b,d):setTimeout(b,n),void 0):(f.reset(),void 0)}function c(){var a,b,c,d=j.get(i);if(d&&0!==d.length)for(d=[].concat(d),a=0,b=d.length;b>a;a++)c=d[a],c.apply(c,arguments)}var d,e=a("wozlla/wozllajs/1.0.0/utils/Tuple"),f=a("wozlla/wozllajs/1.0.0/core/Time"),g=a("wozlla/wozllajs/1.0.0/core/Stage"),h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(a,b){setTimeout(a,b)},i="Engine",j=new e,k=!0,l=!1,m=30,n=1e3/m;return{addListener:function(a){j.push(i,a)},removeListener:function(a){j.remove(i,a)},start:function(a){d=a||10,k=!0,l?h(b,d):b()},stop:function(){k=!1},runStep:function(){f.update(),f.delta=d,c()},setUseRAF:function(a){l=a},setFPS:function(a){m=a}}}),define("wozlla/wozllajs/1.0.0/utils/Tuple",[],function(){var a=function(){this.data={}};return a.prototype={push:function(a,b){this.data[a]=this.data[a]||[],this.data[a].push(b)},get:function(a){return void 0===a?this.data:this.data[a]||[]},sort:function(a,b){return this.data[a].sort(b),this},remove:function(a,b){var c,d,e,f=this.data[a];if(!f)return!1;for(d=0,e=f.length;e>d;d++)if(f[d]===b){c=d;break}return void 0!==c?(f.splice(c,1),!0):!1},clear:function(a){a?this.data[a]=void 0:this.data={}}},a}),define("wozlla/wozllajs/1.0.0/core/Stage",["wozlla/wozllajs/1.0.0/utils/listenAppState","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter","wozlla/wozllajs/1.0.0/core/Touch","wozlla/wozllajs/1.0.0/core/events/TouchEvent"],function(a){var b=(a("wozlla/wozllajs/1.0.0/utils/listenAppState"),a("wozlla/wozllajs/1.0.0/utils/Objects")),c=a("wozlla/wozllajs/1.0.0/math/Rectangle"),d=a("wozlla/wozllajs/1.0.0/core/CachableGameObject"),e=a("wozlla/wozllajs/1.0.0/core/Touch"),f=new c,g=function(a){d.apply(this,arguments),this.autoClear=a.autoClear,this.bgColor=a.bgColor,this.webgl=a.webgl,this._width=a.width||a.canvas.width,this._height=a.height||a.canvas.height,this.stageCanvas=a.canvas,this.stageCanvas.width=this._width,this.stageCanvas.height=this._height,a.webgl&&WebGL2D?(WebGL2D.enable(this.stageCanvas),this.stageContext=this.stageCanvas.getContext("webgl-2d")):this.stageContext=this.stageCanvas.getContext("2d"),this.drawCalls=[],this.lastPos={x:0,y:0},this.stageDelta={x:0,y:0},g.root=this,e.init(this),this.init()};g.root=null;var h=b.inherits(g,d);return h.isStage=!0,h.addDrawCall=function(a){this.drawCalls.push(a)},h.tick=function(){this.stageDelta.x=this.transform.x-this.lastPos.x,this.stageDelta.y=this.transform.y-this.lastPos.y,this.lastPos.x=this.transform.x,this.lastPos.y=this.transform.y,this.update(),this.lateUpdate(),this.draw();for(var a=0;a<this.drawCalls.length;a++)this.drawCalls[a](this.stageContext,this)},h.draw=function(){this.autoClear&&(this.webgl?this.stageContext.clear(0,0,0,1):this.bgColor?(this.stageContext.fillStyle=this.bgColor,this.stageContext.fillRect(0,0,this._width,this._height)):this.stageContext.clearRect(0,0,this._width,this._height)),d.prototype.draw.apply(this,[this.stageContext,this.getVisibleRect()])},h.resize=function(a,b){this.stageCanvas.width=a,this.stageCanvas.height=b,this._width=a,this._height=b},h.getStageDelta=function(){return this.stageDelta},h.getVisibleRect=function(){return f.x=-this.transform.x,f.y=-this.transform.y,f.width=this._width,f.height=this._height,f},g}),define("wozlla/wozllajs/1.0.0/utils/listenAppState",[],function(){return function(a){var b=function(b){"blur"===b.type?a.onPause():"focus"===b.type&&a.onResume()};navigator.isCocoonJS||"onblur"in window&&(window.onfocus=b,window.onblur=b)}}),define("wozlla/wozllajs/1.0.0/core/Touch",["wozlla/wozllajs/1.0.0/core/events/TouchEvent","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/events/Event"],function(a){function b(){if(f)return f;for(var a=d.stageCanvas,b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return f=b,b}function c(a){if(h){var c,f,m,n,o,p,q,r,s,t=a.type,u="MouseEvent",v=!0;if(n=b(),"mousedown"===t?t=g.TOUCH_START:"mousemove"===t?t=g.TOUCH_MOVE:"mouseup"===t&&(t=g.TOUCH_END),a.changedTouches?a.changedTouches&&(q=a.changedTouches[0],u=q.identifier,o=q.pageX-n.x,p=q.pageY-n.y):(o=a.pageX-n.x,p=a.pageY-n.y),r=t===g.TOUCH_MOVE?k?d.getTopObjectUnderPoint(o,p,!0):e:d.getTopObjectUnderPoint(o,p,!0),t===g.TOUCH_START?(l.length=0,null===j?(j=u,e=r):v=!1):t===g.TOUCH_END&&e?v=u===j:t===g.TOUCH_MOVE&&e&&(v=u===j),i&&v&&r){for(c=0,f=l.length;f>c;c++)if(l[c]===r){m=!0;break}!m&&l.push(r)}e&&v&&(s=new g({type:t,x:o,y:p,bubbles:!0,touch:r,touches:l}),e.dispatchEvent(s),t===g.TOUCH_START?k=s.touchMoveDetection:t===g.TOUCH_END&&(k=!0),t===g.TOUCH_END&&(e&&e===r&&r.dispatchEvent(new g({type:g.CLICK,x:o,y:p,bubbles:!0,touch:r,touches:l})),e=null,j=null))}}var d,e,f,g=a("wozlla/wozllajs/1.0.0/core/events/TouchEvent"),h=!0,i=!1,j=null,k=!0,l=[];return{init:function(a){var b=0,e=a.stageCanvas;d=a,"ontouchstart"in window?(e.addEventListener("touchstart",function(a){b++,c(a)},!1),e.addEventListener("touchend",function(a){b--,c(a)},!1),e.addEventListener("touchmove",function(a){c(a)},!1)):(e.addEventListener("mousedown",function(a){b=!0,c(a)},!1),e.addEventListener("mouseup",function(a){b=!1,c(a)},!1),e.addEventListener("mousemove",function(a){b&&c(a)},!1))},setMultiTouches:function(a){i=a},enable:function(){h=!0},disable:function(){h=!1}}}),define("wozlla/wozllajs/1.0.0/core/GLGameObject",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter"],function(a){var b={},c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/CachableGameObject"),e=a("wozlla/wozllajs/1.0.0/core/events/GameObjectEvent"),f=function(){var a=this;d.apply(this,arguments),this.id&&(b[this.id]=this,this.addEventListener(e.DESTROY,function(c){c.target===a&&(c.removeListener(),delete b[a.id])}))};f.idMap=b;var g=c.inherits(f,d);return g.isRenderable=function(){return!(!this._initialized||!this._active||!this._visible)},g.draw=function(a,b,c){this._initialized&&this._active&&this._visible&&(this._draw(a,b,c),this._doDelayRemove())},g._draw=function(a,b,c){var d,e,f,g=this._children;if(g.length<=0)this.sendMessage("draw",arguments,Renderer);else for(d=0,e=g.length;e>d;d++)f=g[d],f.draw(a,b,c)},f.getById=function(a){return b[a]},f}),define("wozlla/wozllajs/1.0.0/core/WebGLStage",["wozlla/wozllajs/1.0.0/utils/listenAppState","wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/math/Rectangle","wozlla/wozllajs/1.0.0/core/CachableGameObject","wozlla/wozllajs/1.0.0/core/UnityGameObject","wozlla/wozllajs/1.0.0/math/Matrix2D","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/core/AbstractGameObject","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/events/EventTarget","wozlla/wozllajs/1.0.0/events/Event","wozlla/wozllajs/1.0.0/core/events/GameObjectEvent","wozlla/wozllajs/1.0.0/core/Transform","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/core/Behaviour","wozlla/wozllajs/1.0.0/core/Animation","wozlla/wozllajs/1.0.0/core/Time","wozlla/wozllajs/1.0.0/core/Renderer","wozlla/wozllajs/1.0.0/core/Layout","wozlla/wozllajs/1.0.0/core/HitDelegate","wozlla/wozllajs/1.0.0/core/Mask","wozlla/wozllajs/1.0.0/utils/createCanvas","wozlla/wozllajs/1.0.0/core/Filter","wozlla/wozllajs/1.0.0/core/Touch","wozlla/wozllajs/1.0.0/core/events/TouchEvent","wozlla/wozllajs/1.0.0/core/Stage"],function(a){var b=(a("wozlla/wozllajs/1.0.0/utils/listenAppState"),a("wozlla/wozllajs/1.0.0/utils/Objects")),c=(a("wozlla/wozllajs/1.0.0/math/Rectangle"),a("wozlla/wozllajs/1.0.0/core/CachableGameObject")),d=a("wozlla/wozllajs/1.0.0/core/Touch"),e=a("wozlla/wozllajs/1.0.0/core/Stage"),f=a("wozlla/wozllajs/1.0.0/assets/AsyncImage"),g=a("wozlla/wozllajs/1.0.0/core/Renderer"),h=5,i=4,j=i*h,k=6,l=Math.pow(2,16),m=l/4,n=function(a){c.apply(this,arguments),this.autoClear=a.autoClear,this.stageCanvas=a.canvas,this.canvas=a.canvas,this._webGLContext=null,this._viewportWidth=a.width||a.canvas.width,this._viewportHeight=a.height||a.canvas.height,this.stageCanvas.width=this._viewportWidth,this.stageCanvas.height=this._viewportHeight,this._preserveDrawingBuffer=!!a.preserveDrawingBuffer,this._antialias=!!a.antialias,this._webGLErrorDetected=!1,this._projectionMatrix=null,this._clearColor=null,this._maxTexturesPerDraw=1,this._maxBoxesPointsPerDraw=null,this._maxBoxesPerDraw=null,this._maxIndicesPerDraw=null,this._shaderProgram=null,this._vertices=null,this._verticesBuffer=null,this._indices=null,this._indicesBuffer=null,this._currentBoxIndex=-1,this._drawTexture=null,this.initWebGL(),f.webGLContext=this._webGLContext,this.drawCalls=[],this.lastPos={x:0,y:0},this.stageDelta={x:0,y:0},n.root=this,e.root=this,d.init(this),this.init()};n.root=null;var o=b.inherits(n,c);return o.isStage=!0,o.updateViewport=function(a,b){this._viewportWidth=a,this._viewportHeight=b,this._webGLContext&&(this._webGLContext.viewport(0,0,this._viewportWidth,this._viewportHeight),this._projectionMatrix||(this._projectionMatrix=new Float32Array([0,0,0,0,0,1,-1,1,1])),this._projectionMatrix[0]=2/a,this._projectionMatrix[4]=-2/b)},o.initWebGL=function(){return this._clearColor={r:0,g:0,b:0,a:0},this.stageCanvas?this._webGLContext&&this._webGLContext.canvas===this.canvas||this.initializeWebGLContext():this._webGLContext=null,this._webGLContext},o.initializeWebGLContext=function(){var a={depth:!1,alpha:!0,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias,premultipliedAlpha:!0},b=this._webGLContext=this.canvas.getContext("webgl",a)||this.canvas.getContext("experimental-webgl",a);if(b){if(this._maxTexturesPerDraw=1,this._setClearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a),b.enable(b.BLEND),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this._createShaderProgram(b),this._webGLErrorDetected)return this._webGLContext=null,void 0;this._createBuffers(b),this.updateViewport(this._viewportWidth||this.canvas.width||0,this._viewportHeight||this.canvas.height||0)}},o._setClearColor=function(a,b,c,d){this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=c,this._clearColor.a=d,this._webGLContext&&this._webGLContext.clearColor(a,b,c,d)},o._createShaderProgram=function(a){var b=this._createShader(a,a.FRAGMENT_SHADER,"precision mediump float;uniform sampler2D uSampler0;varying vec3 vTextureCoord;void main(void) {vec4 color = texture2D(uSampler0, vTextureCoord.st);gl_FragColor = vec4(color.rgb, color.a * vTextureCoord.z);}"),c=this._createShader(a,a.VERTEX_SHADER,"attribute vec2 aVertexPosition;attribute vec3 aTextureCoord;uniform mat3 uPMatrix;varying vec3 vTextureCoord;void main(void) {vTextureCoord = aTextureCoord;gl_Position = vec4((uPMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);}");if(!this._webGLErrorDetected&&b&&c){var d=a.createProgram();if(a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),!a.getProgramParameter(d,a.LINK_STATUS))return this._webGLErrorDetected=!0,void 0;d.vertexPositionAttribute=a.getAttribLocation(d,"aVertexPosition"),d.textureCoordAttribute=a.getAttribLocation(d,"aTextureCoord"),d.sampler0uniform=a.getUniformLocation(d,"uSampler0"),a.enableVertexAttribArray(d.vertexPositionAttribute),a.enableVertexAttribArray(d.textureCoordAttribute),d.pMatrixUniform=a.getUniformLocation(d,"uPMatrix"),a.useProgram(d),this._shaderProgram=d}},o._createShader=function(a,b,c){var d=a.createShader(b);return a.shaderSource(d,c),a.compileShader(d),a.getShaderParameter(d,a.COMPILE_STATUS)?d:(this._webGLErrorDetected=!0,null)},o._createBuffers=function(a){this._verticesBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this._verticesBuffer);var b=4*h;a.vertexAttribPointer(this._shaderProgram.vertexPositionAttribute,2,a.FLOAT,a.FALSE,b,0),a.vertexAttribPointer(this._shaderProgram.textureCoordAttribute,3,a.FLOAT,a.FALSE,b,8),this._indicesBuffer=a.createBuffer(),this._setMaxBoxesPoints(a,m)},o._setMaxBoxesPoints=function(a,b){this._maxBoxesPointsPerDraw=b,this._maxBoxesPerDraw=this._maxBoxesPointsPerDraw/i|0,this._maxIndicesPerDraw=this._maxBoxesPerDraw*k,a.bindBuffer(a.ARRAY_BUFFER,this._verticesBuffer),this._vertices=new Float32Array(this._maxBoxesPerDraw*j),a.bufferData(a.ARRAY_BUFFER,this._vertices,a.DYNAMIC_DRAW),this._indices=new Uint16Array(this._maxIndicesPerDraw);
for(var c=0,d=this._indices.length;d>c;c+=k){var e=c*i/k;this._indices[c]=e,this._indices[c+1]=e+1,this._indices[c+2]=e+2,this._indices[c+3]=e,this._indices[c+4]=e+2,this._indices[c+5]=e+3}a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this._indices,a.STATIC_DRAW)},o._drawWebGLKids=function(a,b,c){var d,e,f=!1,h=0,i=0,k=0,n=0,o=this._vertices,p=j,q=l,r=this._maxBoxesPerDraw-1;console.log("kids length:",a.length);for(var s=0,t=a.length;t>s;s++)if(d=a[s],d.isRenderable()){console.log("draw",d.name),e=d.transform.getMatrix(),e=(c?e.copy(c):e.identity()).appendTransform(d.x,d.y,d.scaleX,d.scaleY,d.rotation,d.skewX,d.skewY,d.regX,d.regY);var u=0,v=1,w=0,x=1,y=d.getComponent(g);if(console.log("isPrepared",y,y.isPreparedToDraw()),y.isPreparedToDraw()){var z=y.getTextureDescription(),A=z.texture;if(h=z.left,i=z.top,k=z.right,n=z.bottom,A!==this._drawTexture&&(this._drawTexture&&this._drawToGPU(b),this._drawTexture=A,b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,A),b.uniform1i(this._shaderProgram.sampler0uniform,0)),console.log("texture",A),null!==A){var B=++this._currentBoxIndex*p,C=e.a,D=e.b,E=e.c,F=e.d,G=e.tx,H=e.ty;f&&d.snapToPixel&&(G=G+(0>G?-.5:.5)|0,H=H+(0>H?-.5:.5)|0),o[B]=h*C+i*E+G,o[B+1]=h*D+i*F+H,o[B+5]=h*C+n*E+G,o[B+6]=h*D+n*F+H,o[B+10]=k*C+n*E+G,o[B+11]=k*D+n*F+H,o[B+15]=k*C+i*E+G,o[B+16]=k*D+i*F+H,o[B+2]=o[B+7]=u,o[B+12]=o[B+17]=v,o[B+3]=o[B+18]=w,o[B+8]=o[B+13]=x,o[B+4]=o[B+9]=o[B+14]=o[B+19]=d.alpha,this._currentBoxIndex===r&&(this._drawToGPU(b),this._drawTexture=A,b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this._drawTexture),b.uniform1i(this._shaderProgram.sampler0uniform,0),this._maxBoxesPointsPerDraw<q&&(this._setMaxBoxesPoints(b,this._maxBoxesPointsPerDraw+m),r=this._maxBoxesPerDraw-1))}d.children&&(this._drawWebGLKids(d.children,b,e),r=this._maxBoxesPerDraw-1)}}},o._drawToGPU=function(a){console.log("draw to GPU");var b=this._currentBoxIndex+1;a.bindBuffer(a.ARRAY_BUFFER,this._verticesBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),a.uniformMatrix3fv(this._shaderProgram.pMatrixUniform,!1,this._projectionMatrix),a.bufferSubData(a.ARRAY_BUFFER,0,this._vertices),a.drawElements(a.TRIANGLES,b*k,a.UNSIGNED_SHORT,0),this._currentBoxIndex=-1,this._drawTexture=null},o.addDrawCall=function(a){this.drawCalls.push(a)},o.tick=function(){this.stageDelta.x=this.transform.x-this.lastPos.x,this.stageDelta.y=this.transform.y-this.lastPos.y,this.lastPos.x=this.transform.x,this.lastPos.y=this.transform.y,this.update(),this.lateUpdate(),this.draw();for(var a=0;a<this.drawCalls.length;a++)this.drawCalls[a](this.stageContext,this)},o.draw=function(){this._webGLContext.clear(this._webGLContext.COLOR_BUFFER_BIT),this._initialized&&this._active&&this._visible&&(console.log("draw stage"),this._drawTexture=null,this._drawWebGLKids(this._children,this._webGLContext,this.transform.getMatrix()))},o.getStageDelta=function(){return this.stageDelta},n}),define("wozlla/wozllajs/1.0.0/math/geom",[],function(){return{vectorLength:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},vectorNormalize:function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y);if(b<=Number.MIN_VALUE)return 0;var c=1/b;return a.x*=c,a.y*=c,b},rectIntersection:function(a,b){return a.x<b.x+b.width&&b.x<a.x+a.width&&a.y<b.y+b.height&&b.y<a.y+a.height},rectIntersection2:function(a,b,c,d,e,f,g,h){return e+g>a&&a+c>e&&f+h>b&&b+d>f},pointInRect:function(a,b){return b.x<=a.x&&b.x+b.width>=a.x&&b.y<=a.y&&b.y+b.height>=a.y},pointInRect2:function(a,b,c,d,e,f){return a>=c&&c+e>=a&&b>=d&&d+f>=b}}}),define("wozlla/wozllajs/1.0.0/component/Image",["wozlla/wozllajs/1.0.0/utils/Objects","wozlla/wozllajs/1.0.0/core/Component","wozlla/wozllajs/1.0.0/assets/loader","wozlla/wozllajs/1.0.0/utils/Strings","wozlla/wozllajs/1.0.0/utils/Arrays","wozlla/wozllajs/1.0.0/utils/Promise","wozlla/wozllajs/1.0.0/utils/Ajax","wozlla/wozllajs/1.0.0/assets/AsyncImage","wozlla/wozllajs/1.0.0/assets/Texture","wozlla/wozllajs/1.0.0/utils/uniqueKey","wozlla/wozllajs/1.0.0/core/Renderer"],function(a){function b(){e.apply(this,arguments),this.image=void 0}var c=a("wozlla/wozllajs/1.0.0/utils/Objects"),d=a("wozlla/wozllajs/1.0.0/core/Component"),e=a("wozlla/wozllajs/1.0.0/core/Renderer"),f=c.inherits(b,e);return f.id="Image",f.alias="c-Image",f.initComponent=function(){var a=this;a.applyProperties()},f.applyProperties=function(){var a=this,b=a.properties.imageSrc;b&&a.loadResource(b).then(function(){a.image=a.getResource(b)}),a.baseline=a.properties.baseline,a.align=a.properties.align},f.destroyComponent=function(){this.image&&this.unloadResource(this.image.resourceId),this.image=null},f.draw=function(a){if(this.image)if(this.baseline||this.align){var b,c,d=this.image.image.height,e=this.image.image.width;c="top"==this.baseline?0:"middle"==this.baseline?-d/2:"bottom"==this.baseline?-d:0,b="start"==this.align?0:"center"==this.align?-e/2:"end"==this.align?-e:0,this.image.draw(a,b,c)}else this.image.draw(a,0,0)},f.isPreparedToDraw=function(){return!!this.image},f.getTextureDescription=function(){return{left:0,top:0,right:this.image.image.width,bottom:this.image.image.height,texture:this.image.glTexture}},d.register(b),b});
